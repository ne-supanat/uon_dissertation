globals [
  population-size
  rain
]

turtles-own [
  archetype
  transport-mode
]

to setup
  clear-all
  set population-size 100
  create-turtles population-size [
    setxy random-xcor random-ycor
    set archetype one-of ["Pragmatic Commuter" "Environmentally Aware Commuter"]
    set transport-mode ""
    set color white
  ]
  set rain false
  reset-ticks
end

to go
  tick
  ifelse random 2 = 0 [set rain true][set rain false]
  ask turtles [
    choose-transport-mode
  ]
  update-plots
  if ticks = 100 [stop]
end

to choose-transport-mode
  ; Determine usual transport mode
  let usual-mode ""
  if archetype = "Pragmatic Commuter" [
    if rain [
      set usual-mode "Driving"
    ] else [
      set usual-mode "Driving"
    ]
  ]
  if archetype = "Environmentally Aware Commuter" [
    if rain [
      set usual-mode "Bus"
    ] else [
      set usual-mode "Tram"
    ]
  ]
  set transport-mode usual-mode
end

to update-plots
  set-current-plot "Transportation Mode Usage"

  set-current-plot-pen "Tram"
  plotxy ticks count turtles with [transport-mode = "Tram"]

  set-current-plot-pen "Cycling"
  plotxy ticks count turtles with [transport-mode = "Cycling"]

  set-current-plot-pen "Bus"
  plotxy ticks count turtles with [transport-mode = "Bus"]

  set-current-plot-pen "Driving"
  plotxy ticks count turtles with [transport-mode = "Driving"]
end
